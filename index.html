<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <title>10 Years Together üíï</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --cream: #fff8f0;
      --paper: #fef9f3;
      --envelope: #e8d5c4;
      --envelope-dark: #d4b8a2;
      --pink: #f4c2c2;
      --pink-dark: #e8a0a0;
      --text: #3d2c2e;
      --outline: #2d1b2e;
      --pixel-size: 4px;
      --stem-green: #5a9e5a;
      --stem-dark: #3d7a3d;
    }

    html {
      image-rendering: pixelated;
      image-rendering: crisp-edges;
    }

    body {
      width: 100%;
      min-width: 320px;
      max-width: 390px;
      min-height: 100vh;
      min-height: 100dvh;
      min-height: -webkit-fill-available;
      margin: 0 auto;
      padding: 1rem;
      padding-left: max(1rem, env(safe-area-inset-left));
      padding-right: max(1rem, env(safe-area-inset-right));
      padding-top: max(1rem, env(safe-area-inset-top));
      padding-bottom: max(1.5rem, env(safe-area-inset-bottom));
      background: #e8dce8;
      background-image:
        linear-gradient(rgba(0,0,0,.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0,0,0,.03) 1px, transparent 1px);
      background-size: var(--pixel-size) var(--pixel-size);
      font-family: 'Press Start 2P', cursive;
      color: var(--text);
      overflow-x: hidden;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: relative;
    }

    /* Pixel sparkles */
    .sparkle {
      position: fixed;
      width: 8px;
      height: 8px;
      background: var(--pink);
      border: 2px solid var(--outline);
      animation: twinkle 3s ease-in-out infinite;
      pointer-events: none;
    }
    .sparkle:nth-child(1) { left: 10%; top: 20%; animation-delay: 0s; }
    .sparkle:nth-child(2) { left: 85%; top: 15%; animation-delay: 0.5s; }
    .sparkle:nth-child(3) { left: 25%; top: 80%; animation-delay: 1s; }
    .sparkle:nth-child(4) { left: 70%; top: 70%; animation-delay: 1.5s; }
    .sparkle:nth-child(5) { left: 50%; top: 10%; animation-delay: 2s; }
    .sparkle:nth-child(6) { left: 15%; top: 50%; animation-delay: 0.8s; }
    .sparkle:nth-child(7) { left: 90%; top: 45%; animation-delay: 1.2s; }
    @keyframes twinkle {
      0%, 100% { opacity: 0.4; transform: scale(1); }
      50% { opacity: 1; transform: scale(1); }
    }

    h1 {
      font-family: 'Press Start 2P', cursive;
      font-size: clamp(0.65rem, 4vw, 1rem);
      color: var(--pink-dark);
      margin-bottom: 2rem;
      text-align: center;
      line-height: 1.8;
      text-shadow:
        -1px -1px 0 var(--outline),
        1px -1px 0 var(--outline),
        -1px 1px 0 var(--outline),
        1px 1px 0 var(--outline);
      opacity: 0;
      transform: translateY(-20px);
      transition: opacity 0.6s ease, transform 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
    }
    h1.animate-in {
      opacity: 1;
      transform: translateY(0);
    }

    .scene {
      position: relative;
      width: 100%;
      margin-top: 7rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 2rem;
      opacity: 0;
      transform: translateY(24px);
      transition: opacity 0.7s ease 0.2s, transform 0.7s cubic-bezier(0.34, 1.56, 0.64, 1) 0.2s;
    }
    .scene.animate-in {
      opacity: 1;
      transform: translateY(0);
    }

    /* Envelope container */
    .envelope-wrapper {
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      cursor: pointer;
      filter: drop-shadow(0 8px 24px rgba(92, 74, 61, 0.2));
      transition: transform 0.3s ease;
      perspective: 1000px;
      transform-style: preserve-3d;
    }
    .envelope-wrapper:hover:not(.opened) {
      transform: scale(1.02);
    }
    .envelope-wrapper.opened {
      cursor: pointer;
    }
    .envelope-wrapper.opened:hover {
      transform: scale(1);
    }

    .envelope {
      position: relative;
      width: 280px;
      height: 180px;
      background: var(--envelope);
      border: 3px solid var(--outline);
      box-shadow: 6px 6px 0 var(--outline);
      transform-style: preserve-3d;
      transform: translateZ(0);
    }

    /* Envelope flap - pixel style */
    .envelope-flap {
      position: absolute;
      top: 0;
      left: 0;
      width: 0;
      height: 0;
      border-left: 140px solid transparent;
      border-right: 140px solid transparent;
      border-top: 100px solid var(--envelope-dark);
      filter: drop-shadow(0 -3px 0 var(--outline));
      transform-origin: top center;
      transition: transform 0.7s cubic-bezier(0.34, 1.56, 0.64, 1);
      backface-visibility: hidden;
    }
    .envelope-wrapper.opened .envelope-flap {
      transform: rotateX(-180deg);
    }

    /* Envelope inner triangle (front) */
    .envelope-inner {
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 140px solid transparent;
      border-right: 140px solid transparent;
      border-bottom: 90px solid rgba(212, 184, 162, 0.5);
      z-index: 1;
    }

    /* Letter - pixel style */
    .letter {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 340px;
      max-height: 55vh;
      min-height: 160px;
      background: var(--paper);
      padding: 1.25rem 1.1rem;
      z-index: 2;
      opacity: 0;
      pointer-events: none;
      overflow: visible;
      transition: opacity 0.5s ease 0.3s, transform 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) 0.2s;
      border: 3px solid var(--outline);
      box-shadow: 6px 6px 0 var(--outline);
    }
    .envelope-wrapper.opened .letter {
      opacity: 1;
      transform: translate(-50%, -82%);
      pointer-events: auto;
      max-height: 72dvh;
      max-width: min(340px, calc(100vw - 2rem));
      overflow-x: hidden;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }
    .envelope-wrapper.opened .letter::-webkit-scrollbar {
      display: none;
    }

    .letter p {
      font-family: 'Press Start 2P', cursive;
      font-size: clamp(0.38rem, 1.8vw, 0.48rem);
      line-height: 1.9;
      color: var(--text);
      text-align: center;
      margin-bottom: 0.5rem;
    }
    .letter p:last-child {
      margin-bottom: 0;
    }
    .letter .signature {
      margin-top: 0.5rem;
      font-size: clamp(0.38rem, 1.8vw, 0.48rem);
      color: var(--pink-dark);
    }
    .letter .heart-line {
      font-size: clamp(0.36rem, 1.6vw, 0.45rem);
      margin-bottom: 0.4rem;
    }
    .letter p.reveal-line {
      opacity: 0;
      transform: translateY(8px);
      transition: opacity 0.5s ease, transform 0.5s ease;
    }
    .letter p.reveal-line.visible {
      opacity: 1;
      transform: translateY(0);
    }

    /* Flowers that stay with the letter - images from flowers/ folder */
    .letter-flowers {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      pointer-events: none;
      overflow: visible;
    }
    .letter-flower {
      position: absolute;
      width: 36px;
      height: 36px;
      opacity: 0;
      transition: opacity 0.5s ease 0.4s;
      animation: flower-float 3s ease-in-out infinite;
      filter: drop-shadow(0 1px 3px rgba(0,0,0,0.12));
    }
    .letter-flower img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      display: block;
    }
    .envelope-wrapper.opened .letter .letter-flower {
      opacity: 1;
    }
    .letter-flower:nth-child(1) { top: -4px; left: -2px; animation-delay: 0s; }
    .letter-flower:nth-child(2) { top: -4px; right: -2px; left: auto; animation-delay: 0.4s; }
    .letter-flower:nth-child(3) { bottom: -4px; left: -2px; top: auto; animation-delay: 0.2s; }
    .letter-flower:nth-child(4) { bottom: -4px; right: -2px; left: auto; top: auto; animation-delay: 0.6s; }
    .letter-flower:nth-child(5) { top: 50%; left: -14px; transform: translateY(-50%); animation-delay: 0.1s; }
    .letter-flower:nth-child(6) { top: 50%; right: -14px; left: auto; transform: translateY(-50%); animation-delay: 0.5s; }
    @keyframes flower-float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-4px); }
    }
    .letter-flower:nth-child(5), .letter-flower:nth-child(6) {
      animation-name: flower-float-side;
    }
    @keyframes flower-float-side {
      0%, 100% { transform: translateY(-50%); }
      50% { transform: translateY(calc(-50% - 4px)); }
    }

    .tap-hint {
      font-family: 'Press Start 2P', cursive;
      font-size: 0.5rem;
      color: var(--pink-dark);
      opacity: 0.9;
      margin-top: 0.5rem;
      text-align: center;
      animation: pulse 2s ease-in-out infinite;
    }
    .envelope-wrapper.opened .tap-hint-open {
      display: none;
    }
    .tap-hint-close {
      display: none;
      font-family: 'Press Start 2P', cursive;
      font-size: 0.5rem;
      color: var(--pink-dark);
      margin-top: 0.5rem;
      text-align: center;
      animation: pulse 2s ease-in-out infinite;
    }
    .envelope-wrapper.opened .tap-hint-close {
      display: block;
    }
    @keyframes pulse {
      0%, 100% { opacity: 0.6; }
      50% { opacity: 1; }
    }

    /* Penguins */
    .penguins {
      display: flex;
      align-items: flex-end;
      gap: 1.5rem;
      margin-top: 1rem;
    }

    .penguin {
      width: 80px;
      height: 100px;
      position: relative;
      animation: wobble 2s ease-in-out infinite;
    }
    .penguin:nth-child(2) {
      animation-delay: 0.3s;
    }
    .penguin.celebrate {
      animation: celebrate 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
    }
    @keyframes celebrate {
      0% { transform: scale(1) rotate(-2deg); }
      40% { transform: scale(1.25) rotate(2deg); }
      70% { transform: scale(1.1) rotate(-1deg); }
      100% { transform: scale(1) rotate(0deg); }
    }
    @keyframes wobble {
      0%, 100% { transform: rotate(-2deg); }
      50% { transform: rotate(2deg); }
    }

    /* Pixel penguins */
    .penguin-body {
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 56px;
      height: 72px;
      background: #1a1a1a;
      border: 2px solid var(--outline);
      clip-path: polygon(0 12px, 12px 0, 44px 0, 56px 12px, 56px 72px, 0 72px);
    }
    .penguin-belly {
      position: absolute;
      bottom: 4px;
      left: 50%;
      transform: translateX(-50%);
      width: 32px;
      height: 44px;
      background: #fff5d6;
      border: 2px solid var(--outline);
      clip-path: polygon(4px 0, 28px 0, 32px 44px, 0 44px);
    }
    .penguin-face {
      position: absolute;
      top: -4px;
      left: 50%;
      transform: translateX(-50%);
      width: 44px;
      height: 40px;
      background: #1a1a1a;
      border: 2px solid var(--outline);
    }
    .penguin-eye {
      position: absolute;
      top: 10px;
      width: 10px;
      height: 10px;
      background: #fff;
      border: 2px solid var(--outline);
    }
    .penguin-eye.left { left: 8px; }
    .penguin-eye.right { right: 8px; }
    .penguin-beak {
      position: absolute;
      bottom: 6px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 6px solid transparent;
      border-right: 6px solid transparent;
      border-top: 10px solid #e88c20;
      filter: drop-shadow(0 2px 0 var(--outline));
    }
    .penguin-wing {
      position: absolute;
      width: 18px;
      height: 32px;
      background: #1a1a1a;
      border: 2px solid var(--outline);
      bottom: 24px;
      transform-origin: top center;
    }
    .penguin-wing.left { left: -6px; transform: rotate(-12deg); }
    .penguin-wing.right { right: -6px; transform: rotate(12deg); }
    .penguin-feet {
      position: absolute;
      bottom: -4px;
      left: 50%;
      transform: translateX(-50%);
      width: 28px;
      height: 8px;
      display: flex;
      justify-content: space-between;
    }
    .penguin-feet::before,
    .penguin-feet::after {
      content: '';
      width: 12px;
      height: 8px;
      background: #e88c20;
      border: 2px solid var(--outline);
    }

    /* Heart in penguin's wing */
    .penguin.holding .penguin-wing.right {
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .penguin-heart {
      position: absolute;
      right: -18px;
      bottom: 5px;
      font-size: 1.4rem;
      animation: heartbeat 1s ease-in-out infinite;
    }
    @keyframes heartbeat {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.15); }
    }

    /* Bow on second penguin - pixel */
    .penguin-bow {
      position: absolute;
      top: -6px;
      right: 0;
      width: 16px;
      height: 12px;
      background: var(--pink);
      border: 2px solid var(--outline);
    }
    .penguin-bow::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 6px;
      height: 6px;
      background: var(--pink-dark);
      border: 1px solid var(--outline);
    }

    footer {
      font-family: 'Press Start 2P', cursive;
      margin-top: 2rem;
      font-size: 0.45rem;
      color: var(--pink-dark);
      opacity: 0;
      transition: opacity 0.6s ease 0.5s;
      text-align: center;
      line-height: 1.8;
    }
    footer.animate-in {
      opacity: 0.8;
    }

    /* Confetti container - full viewport for mobile */
    #confetti-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 9999;
      overflow: visible;
      isolation: isolate;
    }
    .confetti-piece {
      position: absolute;
      opacity: 1;
      will-change: transform, opacity;
    }
    .confetti-piece.confetti-paper {
      width: 14px;
      height: 14px;
      border-radius: 2px;
    }
    .confetti-piece.confetti-heart {
      font-size: 1.75rem;
      line-height: 1;
    }
    .confetti-piece.confetti-flower {
      font-size: 1.85rem;
      line-height: 1;
    }
    .confetti-piece.confetti-pixel {
      width: 36px;
      height: 36px;
      display: inline-block;
    }
    .confetti-piece.confetti-pixel img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      display: block;
    }

    /* Phone / narrow layout - letter above carousel, full width, no overlap */
    @media (max-width: 480px) {
      body { padding: 0.5rem; }
      h1 { font-size: 0.6rem; margin-bottom: 0.6rem; }
      .scene { gap: 0.75rem; margin-top: 3.5rem; }
      .music-box { padding: 0.6rem 0.9rem; gap: 0.35rem; margin-bottom: 0.35rem; }
      .music-box-lid { margin-bottom: 0.15rem; }
      .music-box-btn { width: 40px; height: 40px; font-size: 1rem; }
      .envelope-wrapper.opened .letter {
        position: fixed;
        top: max(0.5rem, env(safe-area-inset-top, 0px));
        left: max(0.35rem, env(safe-area-inset-left, 0px));
        right: max(0.35rem, env(safe-area-inset-right, 0px));
        bottom: calc(96px + 0.75rem + env(safe-area-inset-bottom, 0px));
        transform: none;
        width: auto;
        max-width: none;
        min-height: 180px;
        height: auto;
        overflow-x: hidden;
        overflow-y: auto;
        box-sizing: border-box;
        z-index: 510;
        -webkit-overflow-scrolling: touch;
        scrollbar-width: none;
        -ms-overflow-style: none;
      }
      .envelope-wrapper.opened .letter::-webkit-scrollbar { display: none; }
      body.envelope-open .memories-wrap { z-index: 500; }
      body.envelope-open .carousel-viewport {
        position: absolute;
        top: auto;
        left: 50%;
        bottom: max(0.5rem, env(safe-area-inset-bottom, 0px));
        transform: translate(-50%, 0);
        height: 96px;
      }
      .envelope { width: 240px; height: 156px; }
      .envelope-flap {
        border-left-width: 120px;
        border-right-width: 120px;
        border-top-width: 86px;
      }
      .envelope-inner {
        border-left-width: 120px;
        border-right-width: 120px;
        border-bottom-width: 78px;
      }
      .letter {
        min-height: 140px;
        padding: 0.75rem 0.6rem;
        box-sizing: border-box;
      }
      .envelope-wrapper.opened .letter {
        padding: 0.75rem 0.6rem;
      }
      .letter p { font-size: 0.4rem; line-height: 1.85; }
      .letter .heart-line { font-size: 0.38rem; }
      .letter .signature { font-size: 0.4rem; }
      .tap-hint-open { font-size: 0.45rem; margin-top: 0.25rem; }
      .tap-hint-close { font-size: 0.45rem; margin-top: 0.25rem; }
      .penguins { gap: 0.75rem; margin-top: 0.25rem; }
      .penguin { width: 64px; height: 82px; }
      .penguin-body { width: 46px; height: 62px; clip-path: polygon(0 10px, 10px 0, 36px 0, 46px 10px, 46px 62px, 0 62px); }
      .penguin-belly { width: 26px; height: 36px; clip-path: polygon(2px 0, 24px 0, 26px 36px, 0 36px); }
      .penguin-face { width: 38px; height: 34px; }
      .penguin-eye { width: 8px; height: 8px; top: 8px; }
      .penguin-eye.left { left: 6px; }
      .penguin-eye.right { right: 6px; }
      .penguin-beak { border-left-width: 5px; border-right-width: 5px; border-top-width: 8px; }
      .penguin-wing { width: 14px; height: 26px; bottom: 20px; }
      .penguin-wing.left { left: -5px; }
      .penguin-wing.right { right: -5px; }
      .penguin-feet::before, .penguin-feet::after { width: 10px; height: 6px; }
      .penguin-heart { font-size: 0.9rem; right: -12px; bottom: 4px; }
      .penguin-bow { width: 14px; height: 10px; }
      .penguin-bow::before { width: 5px; height: 5px; }
      footer { font-size: 0.4rem; margin-top: 0.75rem; }
    }

    /* Moving carousel - visible when envelope open, scrolls left to right */
    .memories-wrap {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      pointer-events: none;
      z-index: 500;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.4s ease, visibility 0.4s ease;
    }
    body.envelope-open .memories-wrap {
      opacity: 1;
      visibility: visible;
    }

    /* Music box - visible before opening envelope, play song first */
    .music-box {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.5rem;
      padding: 1rem 1.25rem;
      background: linear-gradient(180deg, var(--paper) 0%, #f5ebe0 100%);
      border: 3px solid var(--outline);
      box-shadow: 5px 5px 0 var(--outline), inset 0 1px 0 rgba(255,255,255,0.5);
      font-family: 'Press Start 2P', cursive;
      margin-bottom: 0.5rem;
    }
    .music-box-lid {
      width: 100%;
      height: 4px;
      background: var(--envelope-dark);
      border: 2px solid var(--outline);
      margin-bottom: 0.25rem;
      border-radius: 1px;
    }
    .music-box-label {
      font-size: 0.35rem;
      color: var(--pink-dark);
      text-align: center;
    }
    .music-box-btn {
      width: 48px;
      height: 48px;
      padding: 0;
      border: 3px solid var(--outline);
      background: var(--pink);
      color: var(--text);
      font-size: 1.2rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      line-height: 1;
      box-shadow: 3px 3px 0 var(--outline);
      -webkit-tap-highlight-color: transparent;
      transition: transform 0.15s ease;
    }
    .music-box-btn:hover { background: var(--pink-dark); transform: scale(1.05); }
    .music-box-btn:active { transform: scale(0.98); }
    .music-box-btn:focus { outline: 2px solid var(--outline); outline-offset: 2px; }

    .carousel-viewport {
      position: absolute;
      left: 50%;
      top: 56%;
      transform: translate(-50%, -50%);
      width: 100%;
      max-width: 100%;
      height: 96px;
      overflow: hidden;
    }
    .carousel-track {
      display: flex;
      flex-direction: row;
      align-items: center;
      gap: 16px;
      height: 100%;
      width: max-content;
      animation: carousel-scroll 50s linear infinite;
      will-change: transform;
    }
    body.envelope-open .memories-wrap .carousel-track {
      animation-play-state: running;
    }
    @keyframes carousel-scroll {
      0% { transform: translateX(0); }
      100% { transform: translateX(calc(-100% / 3)); }
    }
    .carousel-item {
      position: relative;
      flex-shrink: 0;
      width: 80px;
      height: 80px;
      border-radius: 10px;
      overflow: visible;
      border: 3px solid var(--outline);
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }
    .carousel-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      border-radius: 7px;
    }
    .carousel-item .pixel-pet {
      position: absolute;
      width: 26px;
      height: 26px;
      z-index: 2;
      overflow: hidden;
    }
    .carousel-item .pixel-pet img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      display: block;
      image-rendering: pixelated;
      image-rendering: crisp-edges;
    }
    .carousel-item .pixel-pet.corner-tl { top: -5px; left: -5px; }
    .carousel-item .pixel-pet.corner-tr { top: -5px; right: -5px; left: auto; }
    .carousel-item .pixel-pet.corner-bl { bottom: -5px; left: -5px; top: auto; }
    .carousel-item .pixel-pet.corner-br { bottom: -5px; right: -5px; left: auto; top: auto; }
  </style>
</head>
<body>
  <div class="sparkle"></div>
  <div class="sparkle"></div>
  <div class="sparkle"></div>
  <div class="sparkle"></div>
  <div class="sparkle"></div>
  <div class="sparkle"></div>
  <div class="sparkle"></div>

  <h1>10 Years Together üíï</h1>

  <div class="scene">
    <div class="music-box" aria-label="Music box ‚Äì play our song">
      <audio id="letter-music" preload="metadata" loop>
        <source src="Justin%20Bieber%20-%20Lifetime.mp3" type="audio/mpeg">
      </audio>
      <div class="music-box-lid" aria-hidden="true"></div>
      <span class="music-box-label">Play Song First</span>
      <button type="button" class="music-box-btn" id="music-box-play-btn" aria-label="Play music">‚ñ∂</button>
    </div>
    <div class="envelope-wrapper" id="envelope" role="button" tabindex="0" aria-label="Open envelope">
      <div class="envelope">
        <div class="envelope-inner"></div>
        <div class="envelope-flap"></div>
        <div class="letter">
          <div class="letter-flowers" aria-hidden="true">
            <span class="letter-flower"><img src="flowers/iq8u65d6nvev1415rb3j0sbfeu-f8507cc2a651bc1bfefaa8af8968a3b0.png" alt=""></span>
            <span class="letter-flower"><img src="flowers/ac7ladmi02vths0bsgf9510nk8-fb150c79a8a0374595b91b265a1f874c.png" alt=""></span>
            <span class="letter-flower"><img src="flowers/ac7ladmi02vths0bsgf9510nk8-fb150c79a8a0374595b91b265a1f874c.png" alt=""></span>
            <span class="letter-flower"><img src="flowers/580sql68pvv9kiufngd7igm1vj.png" alt=""></span>
            <span class="letter-flower"><img src="flowers/580sql68pvv9kiufngd7igm1vj.png" alt=""></span>
            <span class="letter-flower"><img src="flowers/iq8u65d6nvev1415rb3j0sbfeu-f8507cc2a651bc1bfefaa8af8968a3b0.png" alt=""></span>
          </div>
          <p class="heart-line">‚ù§Ô∏è 10 Years to Us ‚ù§Ô∏è</p>
          <p>Dear Courtney Joyce Chiu,<p>
          <p>From the moment we met in middle school, I had no idea that the girl I awkwardly asked to the dance would become the love of my life.</p>
          <p>We‚Äôve grown up together. We‚Äôve seen each other at our most awkward, our most uncertain, and our most ambitious. We‚Äôve changed, we‚Äôve learned, we‚Äôve faced challenges but somehow, through all of it, we kept choosing each other.</p>
          <p>You‚Äôve been there for every milestone. Every late night talk about our dreams. Every setback that felt overwhelming. Every laugh that hurt our stomachs. You grew up with me.</p>
          <p>You are my comfort, my biggest supporter, and my best friend.</p>
          <p>We started as kids who didn‚Äôt know what the future would look like. And now, standing here, I know exactly what I want my future to look like. I want it with you.</p>
          <p>I want more inside jokes. More adventures. More random doing nothing days where we just hang out and laugh. I want to build a life with you, and keep choosing you every single day.</p>
          <p>So here we are not those middle school kids anymore, but two people who grew up loving each other.</p>
          <p>Thank you for always seeing the best in me, and for always being there for me through it all. I love you more than words can say, and I can't wait to spend the rest of my life with you. Happy 10th Anniversary Baby, I wouldnt want to do it with anyone else.</p>
          <p class="signature">Forever Yours, Albert Huynh</p>
        </div>
      </div>
      <p class="tap-hint tap-hint-open">Click or Tap the Envelope to Open</p>
      <p class="tap-hint-close">Double Tap to Close</p>
    </div>

    <div class="penguins">
      <div class="penguin">
        <div class="penguin-body">
          <div class="penguin-belly"></div>
        </div>
        <div class="penguin-face">
          <div class="penguin-eye left"></div>
          <div class="penguin-eye right"></div>
          <div class="penguin-beak"></div>
        </div>
        <div class="penguin-wing left"></div>
        <div class="penguin-wing right">
          <span class="penguin-heart" aria-hidden="true">‚ù§Ô∏è</span>
        </div>
        <div class="penguin-feet"></div>
      </div>
      <div class="penguin holding">
        <div class="penguin-body">
          <div class="penguin-belly"></div>
        </div>
        <div class="penguin-face">
          <div class="penguin-eye left"></div>
          <div class="penguin-eye right"></div>
          <div class="penguin-beak"></div>
          <div class="penguin-bow"></div>
        </div>
        <div class="penguin-wing left"></div>
        <div class="penguin-wing right"></div>
        <div class="penguin-feet"></div>
      </div>
    </div>
  </div>

  <footer id="footer">Made with love for our 10 year anniversary üêß</footer>

  <div id="confetti-container" aria-hidden="true"></div>

  <div class="memories-wrap" id="memories-wrap" aria-hidden="true">
    <div class="carousel-viewport">
      <div class="carousel-track" id="carousel-track"></div>
    </div>
  </div>

  <script>
    const envelope = document.getElementById('envelope');
    const letter = document.querySelector('.letter');
    const letterLines = document.querySelectorAll('.letter p');
    const penguins = document.querySelectorAll('.penguin');
    const footer = document.getElementById('footer');
    const confettiContainer = document.getElementById('confetti-container');
    const carouselTrack = document.getElementById('carousel-track');

    // Your 6 images ‚Äì put photos in the images/ folder
    const MEMORY_IMAGES = [
      'images/IMG_0016.png',
      'images/IMG_0193.png',
      'images/IMG_0635.png',
      'images/IMG_1487.png',
      'images/IMG_6234.png',
      'images/IMG_6569.png'
    ];

    const HEARTS = ['‚ù§Ô∏è', 'üíï', 'üíó', 'üíñ', '‚ú®', 'üêß'];
    const FLOWERS = ['üå∏', 'üå∑', 'üåπ', 'üíê', 'üå∫', 'üåª', 'ü™∑', 'üíÆ'];
    const PIXEL_IMAGES = ['pixel/bunny.png', 'pixel/clefairy.png', 'pixel/doggy.png', 'pixel/helloykitty.png', 'pixel/jigglypuffpixel.png', 'pixel/kirbypixel.png', 'pixel/pandapixel.png', 'pixel/ramen.png', 'pixel/sealpixel.png'];
    const CONFETTI_COLORS = ['#f4c2c2', '#e8a0a0', '#ffb6c1', '#ffd700', '#fff5ee', '#ffe4e1', '#dda0dd', '#98fb98'];
    const PAPER_COUNT = 50;
    const HEART_COUNT = 20;
    const FLOWER_COUNT = 22;
    const PIXEL_COUNT = 14;
    const DURATION_MS = 28000;

    // ---- Page load: staggered entrance ----
    function runEntranceAnimations() {
      requestAnimationFrame(() => {
        document.querySelector('h1').classList.add('animate-in');
      });
      setTimeout(() => {
        document.querySelector('.scene').classList.add('animate-in');
      }, 150);
      setTimeout(() => {
        footer.classList.add('animate-in');
      }, 500);
    }
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', runEntranceAnimations);
    } else {
      runEntranceAnimations();
    }

    // ---- Confetti burst: slower, smoother, stays visible longer ----
    function burstConfetti(originX, originY) {
      if (!confettiContainer) return;
      confettiContainer.innerHTML = '';
      confettiContainer.style.display = 'block';
      var start = performance.now();
      var gravity = 0.00014;
      var pieces = [];

      function addPiece(type) {
        var el = document.createElement('span');
        if (type === 'paper') {
          el.className = 'confetti-piece confetti-paper';
          el.style.background = CONFETTI_COLORS[Math.floor(Math.random() * CONFETTI_COLORS.length)];
        } else if (type === 'heart') {
          el.className = 'confetti-piece confetti-heart';
          el.textContent = HEARTS[Math.floor(Math.random() * HEARTS.length)];
        } else if (type === 'pixel') {
          el.className = 'confetti-piece confetti-pixel';
          var img = document.createElement('img');
          img.src = PIXEL_IMAGES[Math.floor(Math.random() * PIXEL_IMAGES.length)];
          img.alt = '';
          el.appendChild(img);
        } else {
          el.className = 'confetti-piece confetti-flower';
          el.textContent = FLOWERS[Math.floor(Math.random() * FLOWERS.length)];
        }
        var angle = Math.random() * Math.PI * 2;
        var speed = 18 + Math.random() * 18;
        var data = {
          vx: Math.cos(angle) * speed,
          vy: -4 - Math.random() * 16,
          rot0: Math.random() * 360,
          rotSpeed: (Math.random() - 0.5) * 0.05,
          wobble: (Math.random() - 0.5) * 0.6,
          seed: Math.random() * 10
        };
        el.style.left = originX + 'px';
        el.style.top = originY + 'px';
        el.style.transform = 'translate(-50%, -50%)';
        confettiContainer.appendChild(el);
        pieces.push({ el: el, data: data });
      }

      for (var i = 0; i < PAPER_COUNT; i++) addPiece('paper');
      for (var i = 0; i < HEART_COUNT; i++) addPiece('heart');
      for (var i = 0; i < FLOWER_COUNT; i++) addPiece('flower');
      for (var i = 0; i < PIXEL_COUNT; i++) addPiece('pixel');

      var RAMP_MS = 5500;
      function tick(now) {
        var elapsed = now - start;
        var t = Math.min(elapsed / DURATION_MS, 1);
        var effectiveElapsed = elapsed < RAMP_MS ? (elapsed * elapsed / RAMP_MS) : (elapsed - RAMP_MS * 0.5);

        for (var i = 0; i < pieces.length; i++) {
          var p = pieces[i];
          var d = p.data;
          var x = d.vx * effectiveElapsed * 0.038 + d.wobble * Math.sin(elapsed * 0.001 + d.seed) * 8;
          var y = d.vy * effectiveElapsed * 0.028 + 0.5 * gravity * elapsed * elapsed;
          var rot = d.rot0 + elapsed * d.rotSpeed;
          var opacity = t > 0.92 ? (1 - t) / 0.08 : 1;
          var scale = 0.97 + 0.12 * Math.sin(elapsed * 0.001 + d.seed);
          p.el.style.transform = 'translate(calc(-50% + ' + x + 'px), calc(-50% + ' + y + 'px)) rotate(' + rot + 'deg) scale(' + scale + ')';
          p.el.style.opacity = String(opacity);
        }

        if (t < 1) requestAnimationFrame(tick);
        else { confettiContainer.innerHTML = ''; confettiContainer.style.display = ''; }
      }
      requestAnimationFrame(tick);
    }

    // ---- Letter lines staggered reveal ----
    function revealLetterLines() {
      letterLines.forEach((line, i) => {
        line.classList.add('reveal-line');
        setTimeout(() => {
          line.classList.add('visible');
        }, 400 + i * 220);
      });
    }

    // ---- Penguin celebration bounce ----
    function celebratePenguins() {
      penguins.forEach((p, i) => {
        p.classList.remove('celebrate');
        void p.offsetWidth;
        setTimeout(() => p.classList.add('celebrate'), i * 80);
        setTimeout(() => p.classList.remove('celebrate'), 700);
      });
    }

    // Pixel images (shared with confetti) ‚Äì from pixel/ folder
    var PIXEL_CORNERS = ['corner-tl', 'corner-tr', 'corner-bl', 'corner-br'];
    // ---- Carousel: build with 3 copies for seamless infinite loop (no visible end) ----
    function buildCarousel() {
      if (!carouselTrack || carouselTrack.children.length > 0) return;
      var pixelIndex = 0;
      function addItem(src, index) {
        var div = document.createElement('div');
        div.className = 'carousel-item';
        var img = document.createElement('img');
        img.src = src;
        img.alt = 'Memory ' + (index + 1);
        img.loading = 'lazy';
        img.onerror = function () { this.style.background = 'var(--pink)'; this.style.minHeight = '100%'; };
        div.appendChild(img);
        var pet = document.createElement('span');
        var whichPixel = PIXEL_IMAGES[pixelIndex % PIXEL_IMAGES.length];
        var whichCorner = PIXEL_CORNERS[Math.floor(Math.random() * PIXEL_CORNERS.length)];
        pet.className = 'pixel-pet ' + whichCorner;
        pet.setAttribute('aria-hidden', 'true');
        var petImg = document.createElement('img');
        petImg.src = whichPixel;
        petImg.alt = '';
        petImg.loading = 'lazy';
        pet.appendChild(petImg);
        div.appendChild(pet);
        pixelIndex++;
        carouselTrack.appendChild(div);
      }
      for (var c = 0; c < 3; c++) {
        MEMORY_IMAGES.forEach(addItem);
      }
    }

    function openEnvelope() {
      if (envelope.classList.contains('opened')) return;
      envelope.classList.add('opened');
      envelope.setAttribute('aria-label', 'Envelope opened');
      document.body.classList.add('envelope-open');

      buildCarousel();

      var letterEl = document.querySelector('.letter');
      if (letterEl) letterEl.scrollTop = 0;

      var originX = window.innerWidth * 0.5;
      var originY = window.innerHeight * 0.45;
      requestAnimationFrame(function () {
        burstConfetti(originX, originY);
      });
      celebratePenguins();
      setTimeout(revealLetterLines, 600);
    }

    function closeEnvelope() {
      if (!envelope.classList.contains('opened')) return;
      envelope.classList.remove('opened');
      envelope.setAttribute('aria-label', 'Open envelope');
      document.body.classList.remove('envelope-open');
      letterLines.forEach((line) => {
        line.classList.remove('reveal-line', 'visible');
      });
    }

    var lastToggleTime = 0;
    var lastCloseTapTime = 0;
    var DOUBLE_TAP_MS = 450;

    function handleEnvelopeTap(e) {
      e.preventDefault();
      var now = Date.now();
      if (envelope.classList.contains('opened')) {
        if (lastCloseTapTime && (now - lastCloseTapTime) < DOUBLE_TAP_MS) {
          lastCloseTapTime = 0;
          closeEnvelope();
        } else {
          lastCloseTapTime = now;
        }
        return;
      }
      if (now - lastToggleTime < 400) return;
      lastToggleTime = now;
      openEnvelope();
    }

    envelope.addEventListener('click', handleEnvelopeTap);
    envelope.addEventListener('touchend', function (e) {
      e.preventDefault();
      handleEnvelopeTap(e);
    }, { passive: false });
    var letterMusic = document.getElementById('letter-music');
    if (letterMusic) letterMusic.volume = 0.2;
    var musicBoxPlayBtn = document.getElementById('music-box-play-btn');
    function setPlayButtonState(playing) {
      var label = playing ? 'Pause music' : 'Play music';
      var icon = playing ? '‚ùö‚ùö' : '‚ñ∂';
      if (musicBoxPlayBtn) { musicBoxPlayBtn.textContent = icon; musicBoxPlayBtn.setAttribute('aria-label', label); }
    }
    function toggleMusic() {
      if (!letterMusic) return;
      if (letterMusic.paused) letterMusic.play();
      else letterMusic.pause();
    }
    if (letterMusic) {
      letterMusic.addEventListener('ended', function () { setPlayButtonState(false); });
      letterMusic.addEventListener('pause', function () { setPlayButtonState(false); });
      letterMusic.addEventListener('play', function () { setPlayButtonState(true); });
    }
    if (musicBoxPlayBtn && letterMusic) {
      musicBoxPlayBtn.addEventListener('click', function (e) { e.stopPropagation(); toggleMusic(); });
    }

    envelope.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        handleEnvelopeTap(e);
      }
    });
  </script>
</body>
</html>
